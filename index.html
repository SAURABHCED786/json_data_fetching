<!DOCTYPE html>
<html>

<head>
    <title>Bind SELECT Element with JSON using JavaScript</title>
</head>

<body onload="Select()">
    <!-- <p>
        <input type="button" style="margin:10px 0;" onclick="Select()" value="Click to SELECT with JSON" />
    </p> -->

    <!--The SELECT element.-->
    <select id="sel" onchange="show(this)">
        <!-- <option value='https://jsonplaceholder.typicode.com/posts' >Post</option> -->
    </select>
    <!-- <p id="loading">Loading...</p> -->
    <p id="msg"></p>
    <table id="dataTable">
    </table>
</body>

<script>
    const allApi_urls = [
        "https://jsonplaceholder.typicode.com/posts",
        "https://jsonplaceholder.typicode.com/users",
        "https://jsonplaceholder.typicode.com/comments"
    ];

    let count = 0;
    function Select() {
        // the json.
        let ele = document.getElementById('sel');
        if (count == 0) {
            for (let i = 0; i < allApi_urls.length; i++) {
                // populate select element with json.
                if (i == 0) {
                    ele.innerHTML = ele.innerHTML + '<option selected id="opt_val" value="' + allApi_urls[0] + '">' + 'Post' + '</option>';
                    show(ele);
                }
                if (i == 1) {
                    ele.innerHTML = ele.innerHTML + '<option id="opt_val" value="' + allApi_urls[1] + '">' + 'User' + '</option>';
                }
                if (i == 2) {
                    ele.innerHTML = ele.innerHTML + '<option id="opt_val" value="' + allApi_urls[2] + '">' + 'Comments' + '</option>';
                }

            }
            count += 1;
        }

    }
    function show(ele) {
        // get the selected value from <select> element and show it.
        let opt_val = ele.options[ele.selectedIndex].value;
        let api_url = opt_val;
        // selected index is my api url
        getapi(api_url);

        async function getapi(url) {
            const response = await fetch(url);
            // Storing data in form of JSON
            var data = await response.json();
            if (response) {                
                // hideloader();
            }
            showing(data);
            // function hideloader() {
            //     document.getElementById('loading').style.display = 'none';
            // }
        }

        let msg = document.getElementById('msg');

        msg.innerHTML = 'Selected URL: <b>' + ele.options[ele.selectedIndex].value + '</b>';
    }

    function showing(data) {
        tab = ` <tr>
                    <th>Id</th>
                    <th>Title</th>
                    <th>Body</th>    
                </tr> `;

        data.forEach(e => {
            if (e.title) {
                console.log("you are right");

                tab += `<tr>
                        <td style='text-align: center;'>${e.id}</td>
                        <td>${e.title}</td>
                        <td>${e.body}</td>
                    </tr>`;
            }
            if (e.username) {
                tab += `<tr>
                        <td style='text-align: center;'>${e.username}</td>
                        <td>${e.name}</td>
                        <td>${e.email}</td>
                    </tr>`;
            }
            if (e.postId) {
                tab += `<tr>
                        <td style='text-align: center;'>${e.id}</td>
                        <td>${e.name}</td>
                        <td>${e.body}</td>
                    </tr>`;
            }
        });
        document.getElementById('dataTable').innerHTML = tab;
    }
</script>

</html>